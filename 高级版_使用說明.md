# Google Apps Script - 高級版本
## 智能情境實務測驗表單生成器

---

## 🎯 功能概述

一個**智能習題自動生成系統**，讓你可以根據需求快速生成符合以下條件的 Google Form：

✅ **選擇做題數量** - 5題、10題、20題、30題、全部或自訂
✅ **選擇年份範圍** - 可選單年或多年份組合（110-114年）
✅ **隨機抽題** - 自動從選定範圍隨機抽取指定數量的題目
✅ **隨機排序** - 可選擇按原順序或隨機排序
✅ **自動生成** - 提交配置表單後自動生成測驗 Google Form

---

## 🚀 快速開始（3步）

### 步驟 1️⃣：準備 CSV 檔案

確保以下檔案在你的 Google Drive 中：
- `情境實務_全年版.csv` ✓

### 步驟 2️⃣：設置 Google Apps Script

1. 前往 [Google Apps Script](https://script.google.com)
2. 建立新專案
3. 複製 `GoogleAppsScript_AdvancedVersion.gs` 中的完整代碼
4. 保存專案

### 步驟 3️⃣：執行主函數

1. 選擇函數：`createMainForm()`
2. 點擊 ▶️ **執行**
3. 授權應用程式
4. 等待執行完成

**完成！** 你會獲得一個配置表單連結

---

## 📋 使用配置表單

執行 `createMainForm()` 後，會生成一個 **「情境實務測驗 - 習題生成器」** 表單

### 表單欄位說明：

#### 1️⃣ 你想做多少題？（必填）
- **5題** - 快速練習
- **10題** - 標準練習
- **20題** - 完整測驗
- **30題** - 深度複習
- **全部（98題）** - 全套題庫
- **自訂數量** - 輸入 1-98 之間的任意數字

**示例：** 選擇「自訂數量」，然後在下一欄輸入 `15`

#### 2️⃣ 自訂題數（選填）
- 當上面選擇「自訂數量」時填寫
- 輸入範圍：1-98
- **示例：** 輸入 `15` 就會出現 15 題

#### 3️⃣ 選擇年份（可複選）
- ☐ 110年警察特考
- ☐ 111年警察特考
- ☐ 112年警察特考
- ☐ 113年警察特考
- ☐ 114年警察特考

**說明：**
- 可以同時勾選多個年份
- 不勾選任何年份 = 從全部年份抽題
- **示例 1：** 只勾選 112、113、114 = 只從近三年抽題
- **示例 2：** 都不勾選 = 從全部 98 題中隨機抽題

#### 4️⃣ 題目順序（必填）
- **按原順序** - 按年份順序顯示
- **隨機排序** - 打亂題目順序

#### 5️⃣ 題目難度範圍（可選）
- **不限** - 所有題目
- **前半部分（1-10題）** - 相對簡單
- **後半部分（11-20題）** - 相對困難
- **全部** - 不限

---

## 📊 使用場景與範例

### 場景 1：快速晨間練習（5題隨機）
1. **題數選擇：** 5題
2. **年份選擇：** 都不勾選（全部）
3. **排序方式：** 隨機排序
4. **難度：** 不限

✅ **結果：** 自動從全部 98 題中隨機抽 5 題，亂序呈現

---

### 場景 2：複習特定年份（112、113、114 年）
1. **題數選擇：** 20題
2. **年份選擇：** 勾選 112、113、114 年
3. **排序方式：** 按原順序
4. **難度：** 不限

✅ **結果：** 從近三年共 59 題中隨機抽 20 題，保持原順序

---

### 場景 3：分章節練習（每章 10 題）
1. **題數選擇：** 自訂數量 → 輸入 `10`
2. **年份選擇：** 只勾選某一年（如 113 年）
3. **排序方式：** 隨機排序
4. **難度：** 後半部分

✅ **結果：** 從 113 年後 10 題中隨機抽 10 題，亂序呈現

---

### 場景 4：完整模擬測驗（全部 98 題）
1. **題數選擇：** 全部（98題）
2. **年份選擇：** 都不勾選（全部）
3. **排序方式：** 隨機排序
4. **難度：** 不限

✅ **結果：** 所有 98 題，亂序呈現，完整模擬考試

---

## ⚙️ 運作原理

```
[配置表單]
    ↓ 填寫並提交
[Apps Script 處理]
    ↓ 解析回應
[篩選題目]
    ├─ 按年份篩選
    ├─ 按難度篩選
    └─ 隨機抽取指定數量
    ↓
[自動生成 Google Form]
    ├─ 設置標題（包含題數、年份）
    ├─ 添加所有題目及選項
    ├─ 設置進度條
    └─ 生成分享連結
    ↓
[執行日誌顯示連結]
    └─ 點擊即可開始測驗
```

---

## 🔗 查看生成結果

### 方式 1：執行日誌（推薦）
1. 在 Apps Script 編輯器中，查看 **「執行記錄」**（底部）
2. 找到最後執行的 `onFormSubmit`
3. 展開日誌，複製顯示的 **「📋 表單連結」**
4. 貼到瀏覽器並打開

### 方式 2：Google Drive
1. 打開 Google Drive
2. 搜尋「情境實務測驗」
3. 找到最新生成的表單
4. 開啟並複製分享連結

### 方式 3：Google Forms 頁面
1. 前往 [forms.google.com](https://forms.google.com)
2. 找到最新生成的表單
3. 點擊分享圖示取得連結

---

## 🎨 自訂表單樣式

生成後，你可以在 Google Form 編輯頁面自訂：

1. **佈景主題** - 點擊 🎨 按鈕選擇背景圖片和顏色
2. **標題圖片** - 上傳或選擇題庫的代表圖片
3. **字體** - 改變標題和正文字體
4. **隱藏答案** - 編輯每題，刪除幫助文字中的「正確答案」

**範例主題選擇：**
- 📚 學術風格 - 淡藍色背景
- 💼 專業風格 - 深灰色背景
- 🌟 活力風格 - 鮮豔顏色

---

## 💡 進階技巧

### 技巧 1：建立複習計劃
每日執行一次：
- 週一：10 題（全年份）
- 週二：10 題（110-111 年）
- 週三：10 題（112-113 年）
- 週四：10 題（114 年）
- 週五：20 題（全部隨機）
- 週末：全部 98 題（模擬考）

### 技巧 2：難度漸進式學習
- 第一週：前半部分（1-10題）
- 第二週：全部題目
- 第三週：後半部分（11-20題）
- 第四週：全部題目隨機

### 技巧 3：針對弱點複習
- 第 1 次：20 題，記錄錯誤題號
- 第 2 次：20 題（隨機），再次遇到錯題
- 第 3 次：10 題（專注錯題年份）

---

## 🔄 重複生成新表單

每次提交配置表單都會生成**全新的表單**，所以你可以：

- ✅ 每天生成不同的習題組合
- ✅ 針對不同的複習需求生成
- ✅ 與朋友分享生成的不同表單
- ✅ 建立多個版本供不同用途

**提示：** 生成的表單會自動保存到 Google Drive，你可以隨時存取之前生成的表單。

---

## 🆘 常見問題

### Q1：配置表單在哪裡？
**A：** 執行 `createMainForm()` 後，檢查執行日誌，找到「分享連結」，複製並打開

### Q2：提交配置表單後沒有生成新表單？
**A：**
- 檢查 CSV 檔案 `情境實務_全年版.csv` 是否在 Google Drive
- 檢查 Apps Script 執行日誌是否有錯誤訊息
- 確保已授予 Apps Script 必要的權限

### Q3：生成的表單為什麼沒有選項？
**A：** 確保 CSV 檔案包含完整的「A、B、C、D」選項

### Q4：可以編輯已生成的表單嗎？
**A：** 可以！每個生成的表單都可以在 Google Form 編輯頁面修改

### Q5：如何限制學生的做題數量？
**A：** 在配置表單中選擇「自訂數量」，輸入想要的題數（如 5、10、15 等）

### Q6：可以批量生成多個表單嗎？
**A：** 可以！重複提交配置表單即可生成多個不同的表單

### Q7：如何確保每次隨機抽題都不重複？
**A：** Apps Script 每次執行都會重新隨機選擇，確保題目組合不同

---

## 📧 需要幫助？

如遇到問題，請檢查以下項目：

1. ✅ CSV 檔案是否已上傳到 Google Drive
2. ✅ 檔案名稱是否完全相符：`情境實務_全年版.csv`
3. ✅ Apps Script 是否已授權存取 Google Drive
4. ✅ 執行日誌中是否有紅色的錯誤訊息
5. ✅ 網路連接是否正常

---

## 📝 更新日誌

### v1.0（當前版本）
- ✅ 支持選擇題數
- ✅ 支持選擇年份
- ✅ 支持隨機抽題
- ✅ 支持隨機排序
- ✅ 自動生成 Google Form
- ✅ 自動觸發器設置

### v2.0（計畫中）
- 🔲 支持難度標籤篩選
- 🔲 支持主題分類篩選
- 🔲 支持自動評分
- 🔲 支持性能追蹤
- 🔲 支持批量生成

---

**祝你複習順利！考試加油！** 🎓