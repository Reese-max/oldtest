# 考古題處理系統配置文件
# Archaeology Questions Processing System Configuration

# PDF 處理配置
processing:
  # 文本處理限制
  max_text_length: 1000000      # 最大文本長度
  min_question_length: 10       # 最小題目長度
  max_question_length: 1000     # 最大題目長度
  max_pages: 200                # 最大處理頁數
  memory_cleanup_interval: 50   # 記憶體清理間隔（頁）

  # AI 處理設定
  ai_model: "gemini-1.5-flash"  # AI 模型
  ai_temperature: 0.1           # AI 溫度參數
  ai_max_tokens: 4000           # AI 最大 token 數

  # 答案模式（正則表達式）
  answer_patterns:
    - '(\d+)\.\s*([ABCD])'      # 1. A
    - '(\d+)\s*([ABCD])'        # 1 A
    - '第(\d+)題\s*([ABCD])'    # 第1題 A
    - '(\d+)\s*：\s*([ABCD])'   # 1：A

  corrected_answer_patterns:
    - '更正\s*(\d+)\.\s*([ABCD])'      # 更正 1. B
    - '更正答案\s*(\d+)\.\s*([ABCD])'  # 更正答案 1. B
    - '更正\s*第(\d+)題\s*([ABCD])'    # 更正 第1題 B
    - '更正\s*(\d+)\s*：\s*([ABCD])'   # 更正 1：B

  # 輸出設定
  output_encoding: utf-8-sig    # 輸出編碼
  csv_delimiter: ","            # CSV 分隔符

# Google 表單配置
google_form:
  # 表單設定
  form_title: "考古題練習表單"    # 表單標題
  form_description: "此表單包含 {total_questions} 題考古題，用於練習和自測"  # 表單描述
  collect_email: true            # 收集電子郵件
  require_login: false           # 要求登入

  # 評分設定
  enable_auto_scoring: true      # 啟用自動評分（新名稱：enable_auto_score）
  show_answers_after_submit: true  # 提交後顯示答案

  # 題目設定
  default_question_type: "選擇題"  # 預設題目類型
  enable_question_groups: true   # 啟用題目分組
  shuffle_options: false         # 隨機選項順序
  required: true                 # 必填題目

# OCR 配置
ocr:
  # OCR 啟用設定
  enable_ocr: false            # 是否啟用 OCR
  ocr_fallback: true           # OCR 失敗時是否降級到傳統方法

  # 基礎設置
  pdf_to_image_dpi: 300        # PDF 轉圖片 DPI
  pdf_to_image_zoom: 2.0       # PDF 轉圖片縮放
  confidence_threshold: 0.5    # 信心度閾值
  min_quality_score: 0.6       # 最低品質分數
  use_gpu: false               # 使用 GPU 加速
  lang: ch                     # 語言設置（'ch'=中英文, 'chinese_cht'=繁體中文, 'en'=英文）
  use_structure: false         # 是否使用結構化分析（PP-Structure）

  # 增強功能 (優先級2: OCR深度整合)
  enable_enhanced_ocr: true    # 啟用增強型 OCR

  # 自動掃描版檢測
  auto_detect_scan: true       # 自動檢測掃描版 PDF
  text_ratio_threshold: 0.1    # 文字覆蓋率閾值
  min_words_per_page: 50       # 最少字數判定
  image_ratio_threshold: 0.5   # 圖片覆蓋率閾值

  # 智能參數調優
  auto_tune_parameters: true   # 自動調整 OCR 參數
  auto_tune_dpi: true          # 自動調整 DPI
  auto_tune_threshold: true    # 自動調整閾值
  max_dpi: 400                 # 最大 DPI 限制
  min_dpi: 150                 # 最小 DPI 限制

  # OCR 質量驗證
  enable_quality_check: true   # 啟用質量驗證
  excellent_threshold: 0.9     # 優秀閾值 (>90%)
  good_threshold: 0.7          # 良好閾值 (70-90%)
  fair_threshold: 0.5          # 一般閾值 (50-70%)
  retry_on_poor: true          # 質量差時重試

  # 混合模式處理
  enable_hybrid_mode: true     # 啟用混合模式處理
  hybrid_min_words: 50         # 混合模式文字閾值

  # 性能優化
  ocr_cache_enabled: true      # 啟用 OCR 緩存
  ocr_batch_size: 6            # OCR 批次大小

# 並發處理配置
concurrent:
  max_workers: 4               # 最大 worker 數量
  use_processes: false         # 使用多進程（否則使用多線程）
  batch_size: 50               # 批次大小
  fail_fast: false             # 快速失敗模式

# 日誌配置
logging:
  level: INFO                  # 日誌級別 (DEBUG, INFO, WARNING, ERROR)
  file: logs/app.log          # 日誌文件路徑
  max_size: 10485760          # 最大文件大小 (10MB)
  backup_count: 5             # 備份數量
  format: "%(asctime)s - %(name)s - %(levelname)s - %(message)s"

# 題目掃描追蹤配置
scan_tracking:
  enabled: true                # 啟用掃描追蹤
  save_report: true            # 保存掃描報告
  report_format: json          # 報告格式 (json, txt)

# 性能監控配置
performance:
  enabled: false               # 啟用性能監控
  metrics_interval: 60         # 指標收集間隔（秒）
  save_metrics: false          # 保存性能指標

# 錯誤恢復配置
error_recovery:
  max_retries: 3               # 最大重試次數
  retry_delay: 2               # 重試延遲（秒）
  exponential_backoff: true    # 指數退避

# 輸出配置
output:
  default_dir: output          # 默認輸出目錄
  create_subdirs: true         # 為每個文件創建子目錄
  overwrite_existing: false    # 覆蓋現有文件

# 下載器配置 (優先級1增強功能)
downloader:
  # 並發下載設置
  concurrent_downloads: 5      # 並發下載數量 (1-10，建議3-5)
  enable_concurrent: true      # 啟用並發下載

  # 進度顯示設置
  show_progress_bar: true      # 顯示詳細進度條
  progress_bar_style: bar      # 進度條樣式 (bar, smooth, simple)
  show_download_speed: true    # 顯示下載速度
  show_eta: true               # 顯示預計剩餘時間

  # 斷點續傳設置
  enable_resume: true          # 啟用斷點續傳
  resume_chunk_size: 8192      # 下載區塊大小 (bytes)
  resume_temp_suffix: .part    # 臨時文件後綴
  verify_resume: true          # 驗證續傳文件完整性

  # 連接設置
  connection_timeout: 10       # 連接超時 (秒)
  read_timeout: 120            # 讀取超時 (秒)
  max_retries: 10              # 最大重試次數
  retry_delay: 0.5             # 重試基礎延遲 (秒)

  # 速率限制
  rate_limit_enabled: false    # 啟用速率限制
  max_speed_mbps: 10           # 最大下載速度 (MB/s)

  # 其他
  verify_ssl: false            # 驗證 SSL 證書
  user_agent: "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36"
