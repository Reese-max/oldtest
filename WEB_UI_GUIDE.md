# è€ƒå¤é¡Œè™•ç†ç³»çµ± Web UI ä½¿ç”¨æŒ‡å—

## ğŸ“‹ ç›®éŒ„

1. [ç³»çµ±ç°¡ä»‹](#ç³»çµ±ç°¡ä»‹)
2. [å¿«é€Ÿé–‹å§‹](#å¿«é€Ÿé–‹å§‹)
3. [åŠŸèƒ½ä»‹ç´¹](#åŠŸèƒ½ä»‹ç´¹)
4. [API æ–‡æª”](#api-æ–‡æª”)
5. [å¸¸è¦‹å•é¡Œ](#å¸¸è¦‹å•é¡Œ)
6. [æŠ€è¡“æ¶æ§‹](#æŠ€è¡“æ¶æ§‹)

---

## ç³»çµ±ç°¡ä»‹

è€ƒå¤é¡Œè™•ç†ç³»çµ± Web UI v2.0 æ˜¯ä¸€å€‹å®Œæ•´çš„ Web æ‡‰ç”¨ç¨‹åºï¼Œæ•´åˆäº†ä»¥ä¸‹ä¸‰å¤§æ ¸å¿ƒåŠŸèƒ½ï¼š

### ğŸ•·ï¸ çˆ¬èŸ²ä¸‹è¼‰åŠŸèƒ½
- è‡ªå‹•ä¸‹è¼‰è€ƒé¸éƒ¨è€ƒå¤é¡Œï¼ˆæ°‘åœ‹81-114å¹´ï¼‰
- ä¸¦ç™¼ä¸‹è¼‰ï¼ˆ3-5å€é€Ÿåº¦æå‡ï¼‰
- é€²åº¦å¯¦æ™‚é¡¯ç¤º
- æ–·é»çºŒå‚³æ”¯æŒ
- æ™ºèƒ½é‡è©¦æ©Ÿåˆ¶

### ğŸ” OCR æ·±åº¦æ•´åˆ
- è‡ªå‹•PDFé¡å‹æª¢æ¸¬ï¼ˆæ–‡å­—/æƒæ/æ··åˆï¼‰
- æ™ºèƒ½åƒæ•¸èª¿å„ªï¼ˆDPI 150-400è‡ªé©æ‡‰ï¼‰
- OCRè³ªé‡é©—è­‰
- æ··åˆæ¨¡å¼è™•ç†

### ğŸ“„ PDF é¡Œç›®è§£æ
- æ™ºèƒ½PDFæ–‡å­—æå–
- å¤šç¨®é¡Œå‹æ”¯æŒ
- è‡ªå‹•ç”ŸæˆGoogleè¡¨å–®
- æ‰¹é‡è™•ç†æ”¯æŒ

---

## å¿«é€Ÿé–‹å§‹

### 1. å®‰è£ä¾è³´

```bash
# å®‰è£æ‰€æœ‰ä¾è³´ï¼ˆæ¨è–¦ï¼‰
pip install -r requirements.txt

# æˆ–æœ€å°åŒ–å®‰è£
pip install -r requirements-minimal.txt
pip install Flask>=2.3.0 Werkzeug>=2.3.0
```

### 2. å•Ÿå‹• Web UI

```bash
# ä½¿ç”¨é»˜èªè¨­ç½®ï¼ˆ127.0.0.1:5000ï¼‰
python run_webui.py

# è‡ªå®šç¾©ä¸»æ©Ÿå’Œç«¯å£
python run_webui.py --host 0.0.0.0 --port 8080

# ç”Ÿç”¢æ¨¡å¼ï¼ˆé—œé–‰èª¿è©¦ï¼‰
python run_webui.py --no-debug
```

### 3. è¨ªå•ç•Œé¢

å•Ÿå‹•å¾Œï¼Œæ‰“é–‹ç€è¦½å™¨è¨ªå•ï¼š

- **ä¸»é **: http://localhost:5000/
- **çˆ¬èŸ²æ§åˆ¶å°**: http://localhost:5000/crawler
- **OCRæ§åˆ¶å°**: http://localhost:5000/ocr
- **PDFè™•ç†**: http://localhost:5000/upload
- **æ€§èƒ½ç›£æ§**: http://localhost:5000/monitor

---

## åŠŸèƒ½ä»‹ç´¹

### ğŸ•·ï¸ çˆ¬èŸ²ä¸‹è¼‰æ§åˆ¶å°

**åŠŸèƒ½ç‰¹é»ï¼š**
- éˆæ´»çš„å¹´ä»½é¸æ“‡ï¼ˆå–®ä¸€ã€ç¯„åœã€å¤šå€‹ã€å…¨éƒ¨ï¼‰
- è€ƒè©¦é¡å‹å¤šé¸ï¼ˆè­¦å¯Ÿã€å¸æ³•ç­‰ï¼‰
- å¯¦æ™‚é€²åº¦å’Œæ—¥èªŒé¡¯ç¤º
- ä»»å‹™ç®¡ç†ï¼ˆå•Ÿå‹•ã€åœæ­¢ã€åˆªé™¤ï¼‰

**ä½¿ç”¨æ­¥é©Ÿï¼š**

1. **è¨ªå•çˆ¬èŸ²é é¢**
   ```
   http://localhost:5000/crawler
   ```

2. **é…ç½®ä¸‹è¼‰ä»»å‹™**
   - å¹´ä»½é¸æ“‡ï¼š
     - å–®ä¸€å¹´ä»½ï¼š`113`
     - å¹´ä»½ç¯„åœï¼š`110-113`
     - å¤šå€‹å¹´ä»½ï¼š`110,112,113`
     - å…¨éƒ¨å¹´ä»½ï¼š`all`
   - è€ƒè©¦é¡å‹ï¼šå‹¾é¸éœ€è¦çš„è€ƒè©¦é¡åˆ¥
   - ä¿å­˜ç›®éŒ„ï¼šç•™ç©ºä½¿ç”¨é»˜èªç›®éŒ„

3. **å•Ÿå‹•ä¸‹è¼‰**
   - é»æ“Šã€Œé–‹å§‹ä¸‹è¼‰ã€æŒ‰éˆ•
   - ç³»çµ±æœƒå‰µå»ºä»»å‹™ä¸¦é–‹å§‹åŸ·è¡Œ
   - å¯¦æ™‚é¡¯ç¤ºä¸‹è¼‰é€²åº¦å’Œçµ±è¨ˆ

4. **ç®¡ç†ä»»å‹™**
   - æŸ¥çœ‹ä»»å‹™åˆ—è¡¨
   - åœæ­¢é‹è¡Œä¸­çš„ä»»å‹™
   - åˆªé™¤å·²å®Œæˆçš„ä»»å‹™

**é…ç½®ç¤ºä¾‹ï¼š**

```yaml
# config.yaml
downloader:
  concurrent_downloads: 5      # ä¸¦ç™¼æ•¸é‡
  enable_concurrent: true      # å•Ÿç”¨ä¸¦ç™¼
  show_progress_bar: true      # é¡¯ç¤ºé€²åº¦
  enable_resume: true          # æ–·é»çºŒå‚³
  max_retries: 10              # æœ€å¤§é‡è©¦
```

---

### ğŸ” OCR æ§åˆ¶å°

**åŠŸèƒ½ç‰¹é»ï¼š**
- æ”¯æŒæ‹–æ”¾ä¸Šå‚³PDF
- è‡ªå‹•PDFé¡å‹æª¢æ¸¬
- æ™ºèƒ½åƒæ•¸å„ªåŒ–å»ºè­°
- é…ç½®å¯è¦–åŒ–èª¿æ•´

**ä½¿ç”¨æ­¥é©Ÿï¼š**

1. **è¨ªå•OCRé é¢**
   ```
   http://localhost:5000/ocr
   ```

2. **ä¸Šå‚³PDFæ–‡ä»¶**
   - é»æ“Šä¸Šå‚³å€åŸŸæˆ–æ‹–æ”¾PDFæ–‡ä»¶
   - æ”¯æŒæ–‡å­—å‹ã€æƒæå‹ã€æ··åˆå‹PDF

3. **æª¢æ¸¬PDFé¡å‹**
   - é»æ“Šã€Œæª¢æ¸¬PDFé¡å‹ã€æŒ‰éˆ•
   - æŸ¥çœ‹è©³ç´°åˆ†æçµæœï¼š
     - PDFé¡å‹ï¼ˆæ–‡å­—/æƒæ/æ··åˆï¼‰
     - ç¸½é æ•¸å’Œæ–‡å­—è¦†è“‹ç‡
     - å¹³å‡å­—æ•¸å’Œåœ–ç‰‡æ•¸é‡

4. **å„ªåŒ–OCRåƒæ•¸**
   - é»æ“Šã€Œå„ªåŒ–OCRåƒæ•¸ã€æŒ‰éˆ•
   - ç²å¾—æ™ºèƒ½æ¨è–¦ï¼š
     - æ¨è–¦DPI
     - ç¸®æ”¾å€æ•¸
     - è™•ç†ç­–ç•¥
     - æ€§èƒ½é ä¼°

5. **èª¿æ•´é…ç½®**
   - åˆ‡æ›åŠŸèƒ½é–‹é—œ
   - è¨­ç½®DPIç¯„åœ
   - èª¿æ•´è³ªé‡é–¾å€¼

**æª¢æ¸¬çµæœç¤ºä¾‹ï¼š**

```javascript
{
  "pdf_type": "hybrid",  // æ··åˆå‹PDF
  "analysis": {
    "total_pages": 50,
    "text_pages": 30,
    "scanned_pages": 20,
    "text_ratio": 0.6,
    "avg_chars_per_page": 1500,
    "total_images": 45
  }
}
```

**åƒæ•¸å„ªåŒ–ç¤ºä¾‹ï¼š**

```javascript
{
  "parameters": {
    "dpi": 300,
    "zoom": 2.0,
    "threshold": "auto",
    "strategy": "hybrid",
    "performance_note": "é è¨ˆè™•ç†æ™‚é–“: 2åˆ†é˜"
  }
}
```

---

### ğŸ“„ PDF è™•ç†é é¢

**åŠŸèƒ½ç‰¹é»ï¼š**
- é¡Œç›®è‡ªå‹•è§£æ
- ç”ŸæˆCSVå’ŒGoogle Script
- æ‰¹é‡è™•ç†æ”¯æŒ

**ä½¿ç”¨æ­¥é©Ÿï¼š**

1. **ä¸Šå‚³PDFæ–‡ä»¶**
   - è¨ªå• `/upload`
   - é¸æ“‡é¡Œç›®PDFæ–‡ä»¶

2. **é–‹å§‹è™•ç†**
   - é»æ“Šè™•ç†æŒ‰éˆ•
   - ç­‰å¾…è§£æå®Œæˆ

3. **ä¸‹è¼‰çµæœ**
   - ä¸‹è¼‰CSVæ–‡ä»¶
   - ä¸‹è¼‰Google Script

---

## API æ–‡æª”

### çˆ¬èŸ² API

#### ç²å–é…ç½®
```http
GET /api/crawler/config
```

**éŸ¿æ‡‰ï¼š**
```json
{
  "success": true,
  "available_years": [81, 82, ..., 114],
  "default_keywords": ["è­¦å¯Ÿäººå“¡è€ƒè©¦", ...]
}
```

#### å•Ÿå‹•çˆ¬èŸ²
```http
POST /api/crawler/start
Content-Type: application/json

{
  "years": [113],
  "keywords": ["è­¦å¯Ÿäººå“¡è€ƒè©¦"],
  "save_dir": "/path/to/save"  // å¯é¸
}
```

**éŸ¿æ‡‰ï¼š**
```json
{
  "success": true,
  "task_id": "uuid-string",
  "message": "çˆ¬èŸ²ä»»å‹™å·²å•Ÿå‹•"
}
```

#### ç²å–ä»»å‹™ç‹€æ…‹
```http
GET /api/crawler/status/{task_id}
```

**éŸ¿æ‡‰ï¼š**
```json
{
  "id": "task-id",
  "status": "running",
  "progress": 45,
  "stats": {
    "success": 120,
    "failed": 5,
    "total_size": 52428800
  },
  "logs": [...]
}
```

#### åœæ­¢ä»»å‹™
```http
POST /api/crawler/stop/{task_id}
```

#### åˆªé™¤ä»»å‹™
```http
DELETE /api/crawler/delete/{task_id}
```

---

### OCR API

#### ç²å–é…ç½®
```http
GET /api/ocr/config
```

**éŸ¿æ‡‰ï¼š**
```json
{
  "success": true,
  "config": {
    "enabled": true,
    "auto_detect": true,
    "auto_tune": true,
    "dpi_range": {"min": 150, "max": 400},
    "thresholds": {
      "excellent": 0.9,
      "good": 0.7,
      "fair": 0.5
    }
  }
}
```

#### æª¢æ¸¬PDFé¡å‹
```http
POST /api/ocr/detect
Content-Type: multipart/form-data

file: <PDF file>
```

**éŸ¿æ‡‰ï¼š**
```json
{
  "success": true,
  "pdf_type": "hybrid",
  "analysis": {
    "total_pages": 50,
    "text_pages": 30,
    "scanned_pages": 20,
    "text_ratio": 0.6
  }
}
```

#### å„ªåŒ–OCRåƒæ•¸
```http
POST /api/ocr/optimize
Content-Type: multipart/form-data

file: <PDF file>
```

**éŸ¿æ‡‰ï¼š**
```json
{
  "success": true,
  "pdf_type": "scanned",
  "parameters": {
    "dpi": 300,
    "zoom": 2.0,
    "threshold": "auto",
    "strategy": "ocr"
  }
}
```

---

## å¸¸è¦‹å•é¡Œ

### Q1: å¦‚ä½•å…è¨±å¤–éƒ¨è¨ªå•ï¼Ÿ

ä½¿ç”¨ `--host 0.0.0.0` åƒæ•¸ï¼š

```bash
python run_webui.py --host 0.0.0.0 --port 8080
```

âš ï¸ **å®‰å…¨æç¤º**ï¼šå¤–éƒ¨è¨ªå•éœ€è¦è€ƒæ…®å®‰å…¨æ€§ï¼Œå»ºè­°ä½¿ç”¨é˜²ç«ç‰†å’Œèªè­‰æ©Ÿåˆ¶ã€‚

### Q2: å¦‚ä½•æ›´æ”¹ä¸Šå‚³å’Œè¼¸å‡ºç›®éŒ„ï¼Ÿ

```bash
python run_webui.py \
  --upload-dir /custom/upload \
  --output-dir /custom/output
```

### Q3: çˆ¬èŸ²ä¸‹è¼‰é€Ÿåº¦æ…¢æ€éº¼è¾¦ï¼Ÿ

æª¢æŸ¥é…ç½®ï¼š

```yaml
downloader:
  concurrent_downloads: 10  # å¢åŠ ä¸¦ç™¼æ•¸ï¼ˆ1-10ï¼‰
  enable_concurrent: true
```

### Q4: OCRè™•ç†æ™‚é–“é•·æ€éº¼è¾¦ï¼Ÿ

- æ–‡å­—å‹PDFï¼šä½¿ç”¨æ–‡æœ¬æå–ï¼Œç„¡éœ€OCR
- æƒæå‹PDFï¼šèª¿æ•´DPIè¨­ç½®
- æ··åˆå‹PDFï¼šå•Ÿç”¨æ··åˆæ¨¡å¼

### Q5: å¦‚ä½•æŸ¥çœ‹ç³»çµ±ç‹€æ…‹ï¼Ÿ

è¨ªå•å¥åº·æª¢æŸ¥ç«¯é»ï¼š

```http
GET /health
```

éŸ¿æ‡‰ï¼š
```json
{
  "status": "healthy",
  "timestamp": "2025-11-18T00:00:00",
  "tasks_count": 5,
  "version": "2.0.0"
}
```

---

## æŠ€è¡“æ¶æ§‹

### å¾Œç«¯æ¶æ§‹

```
è€ƒå¤é¡Œè™•ç†ç³»çµ± Web UI
â”‚
â”œâ”€ Flask Application (src/web/app.py)
â”‚  â”œâ”€ Routes (è·¯ç”±)
â”‚  â”‚  â”œâ”€ / (é¦–é )
â”‚  â”‚  â”œâ”€ /crawler (çˆ¬èŸ²æ§åˆ¶å°)
â”‚  â”‚  â”œâ”€ /ocr (OCRæ§åˆ¶å°)
â”‚  â”‚  â”œâ”€ /upload (PDFè™•ç†)
â”‚  â”‚  â””â”€ /monitor (æ€§èƒ½ç›£æ§)
â”‚  â”‚
â”‚  â””â”€ API Endpoints
â”‚     â”œâ”€ /api/crawler/* (çˆ¬èŸ²API)
â”‚     â”œâ”€ /api/ocr/* (OCR API)
â”‚     â””â”€ /api/task/* (ä»»å‹™API)
â”‚
â”œâ”€ Services (æœå‹™å±¤)
â”‚  â”œâ”€ crawler_service.py (çˆ¬èŸ²æœå‹™)
â”‚  â””â”€ ocr_service.py (OCRæœå‹™)
â”‚
â””â”€ Core Modules (æ ¸å¿ƒæ¨¡å¡Š)
   â”œâ”€ enhanced_ocr_processor.py (OCRè™•ç†å™¨)
   â”œâ”€ pdf_processor.py (PDFè™•ç†å™¨)
   â””â”€ è€ƒå¤é¡Œä¸‹è¼‰.py (çˆ¬èŸ²æ¨¡å¡Š)
```

### å‰ç«¯æ¶æ§‹

```
Templates (æ¨¡æ¿)
â”‚
â”œâ”€ base.html (åŸºç¤æ¨¡æ¿)
â”œâ”€ index.html (ä¸»é )
â”œâ”€ crawler.html (çˆ¬èŸ²æ§åˆ¶å°)
â”œâ”€ ocr.html (OCRæ§åˆ¶å°)
â”œâ”€ upload.html (PDFè™•ç†)
â””â”€ monitor.html (æ€§èƒ½ç›£æ§)
```

### é…ç½®ç®¡ç†

```yaml
config.yaml
â”œâ”€ downloader (çˆ¬èŸ²é…ç½®)
â”‚  â”œâ”€ concurrent_downloads: 5
â”‚  â”œâ”€ enable_concurrent: true
â”‚  â”œâ”€ show_progress_bar: true
â”‚  â””â”€ enable_resume: true
â”‚
â”œâ”€ ocr (OCRé…ç½®)
â”‚  â”œâ”€ enable_enhanced_ocr: true
â”‚  â”œâ”€ auto_detect_scan: true
â”‚  â”œâ”€ auto_tune_parameters: true
â”‚  â””â”€ enable_quality_check: true
â”‚
â””â”€ processing (è™•ç†é…ç½®)
   â”œâ”€ max_pages: 200
   â””â”€ output_encoding: utf-8-sig
```

---

## ğŸ¯ æœ€ä½³å¯¦è¸

### 1. çˆ¬èŸ²ä¸‹è¼‰

**æ¨è–¦è¨­ç½®ï¼š**
```yaml
downloader:
  concurrent_downloads: 5  # å¹³è¡¡é€Ÿåº¦å’Œç©©å®šæ€§
  enable_resume: true      # å¿…é ˆå•Ÿç”¨
  max_retries: 10          # æ‡‰å°ç¶²çµ¡æ³¢å‹•
```

**å»ºè­°ï¼š**
- é¦–æ¬¡ä½¿ç”¨ï¼šé¸æ“‡å–®ä¸€å¹´ä»½æ¸¬è©¦
- å¤§æ‰¹é‡ä¸‹è¼‰ï¼šåˆ†æ‰¹é€²è¡Œï¼Œé¿å…å–®æ¬¡ä»»å‹™éå¤§
- ç¶²çµ¡ä¸ç©©å®šï¼šé™ä½ä¸¦ç™¼æ•¸åˆ°3

### 2. OCRè™•ç†

**æ€§èƒ½å„ªåŒ–ï¼š**
- æ–‡å­—å‹PDFï¼šè·³éOCRï¼Œç›´æ¥æå–æ–‡æœ¬
- æƒæå‹PDFï¼šä½¿ç”¨DPI 300-400
- æ··åˆå‹PDFï¼šå•Ÿç”¨æ··åˆæ¨¡å¼

**è³ªé‡ä¿è­‰ï¼š**
- å•Ÿç”¨è³ªé‡é©—è­‰
- è¨­ç½®åˆç†çš„é–¾å€¼
- ä½è³ªé‡è‡ªå‹•é‡è©¦

### 3. ç³»çµ±ç¶­è­·

**å®šæœŸæ¸…ç†ï¼š**
```bash
# æ¸…ç†ä¸Šå‚³æ–‡ä»¶
rm -rf /tmp/exam_uploads/*

# æ¸…ç†è¼¸å‡ºæ–‡ä»¶
rm -rf /tmp/exam_outputs/*
```

**ç›£æ§ç³»çµ±ï¼š**
- å®šæœŸè¨ªå• `/monitor` æŸ¥çœ‹æ€§èƒ½
- é—œæ³¨è¨˜æ†¶é«”ä½¿ç”¨æƒ…æ³
- æª¢æŸ¥ä»»å‹™åŸ·è¡Œç‹€æ…‹

---

## ğŸ“ æ”¯æŒèˆ‡åé¥‹

å¦‚æœ‰å•é¡Œæˆ–å»ºè­°ï¼Œè«‹è¨ªå•ï¼š
- GitHub Issues: https://github.com/yourusername/exam-processor/issues
- æ–‡æª”ä¸­å¿ƒ: æŸ¥çœ‹é …ç›® README.md

---

**ç‰ˆæœ¬ï¼š** 2.0.0
**æ›´æ–°æ—¥æœŸï¼š** 2025-11-18
**ä½œè€…ï¼š** Claude Code
